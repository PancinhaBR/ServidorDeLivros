<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Livraria - Cadastro de Livro</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h2 id="form-title">Cadastro de Livro</h2>
    <form id="form-livro">
        <input type="hidden" id="id-livro">
        <label for="titulo">Título <input type="text" id="titulo" name="titulo"></label>
        <label for="autor">Autor <input type="text" id="autor" name="autor"></label>
        <label for="ano-publicacao">Ano de Publicação <input type="number" id="ano-publicacao" name="ano-publicacao"></label>
        <label for="genero">Gênero <input type="text" id="genero" name="genero"></label>
        <label for="idioma">Idioma <input type="text" id="idioma" name="idioma"></label>
        <label for="preco">Preço <input type="number" step="0.01" id="preco" name="preco"></label>
        <button type="button" id="btn-cadastrar" onclick="enviar()">Cadastrar</button>
        <button type="button" id="btn-editar" onclick="editar()" style="display:none;">Salvar Edição</button>
        <button type="button" onclick="limparFormulario()">Limpar</button>
        <button type="button" onclick="irParaLista()">Ver Lista de Livros</button>
    </form>

    <script>
        // Funções de cadastro, edição e limpeza permanecem
        function enviar(){
            let titulo = document.getElementById('titulo').value;
            let autor = document.getElementById('autor').value;
            let ano_publicacao = document.getElementById('ano-publicacao').value;
            let genero = document.getElementById('genero').value;
            let idioma = document.getElementById('idioma').value;
            let preco = document.getElementById('preco').value;

            if(!titulo || !autor || !ano_publicacao || !genero || !idioma || !preco){
                alert("Preencha todos os campos corretamente!");
                return;
            }
            
            fetch("http://localhost:3000/livros", {
                method: "POST",
                headers: {"Content-type": "application/json"},
                body: JSON.stringify({
                    titulo, autor, ano_publicacao, genero, idioma, preco
                })
            })
            .then(response => response.json())
            .then(function (data) {
                alert(`Livro cadastrado com sucesso!`);
                limparFormulario();
            })
        }

        function editar(){
            let id = document.getElementById('id-livro').value;
            let titulo = document.getElementById('titulo').value;
            let autor = document.getElementById('autor').value;
            let ano_publicacao = document.getElementById('ano-publicacao').value;
            let genero = document.getElementById('genero').value;
            let idioma = document.getElementById('idioma').value;
            let preco = document.getElementById('preco').value;

            fetch(`http://localhost:3000/livros/${id}`, {
                method: "PUT",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({
                    titulo, autor, ano_publicacao, genero, idioma, preco
                })
            })
            .then(response => response.json())
            .then(function (data) {
                limparFormulario();
            });
        }

        function limparFormulario(){
            document.getElementById('form-livro').reset();
            document.getElementById('id-livro').value = "";
            document.getElementById('btn-cadastrar').style.display = "inline";
            document.getElementById('btn-editar').style.display = "none";
            document.getElementById('form-title').innerText = "Cadastro de Livro";
        }
        function irParaLista(){
        window.location.href = "usuarios.html";
        }
    </script>
</body>
</html>
